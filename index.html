<!-- @format -->

<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>제 1회 샌드뱅크 코딩문학 페스티벌</title>
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="styles.css" />
    <style>
      @media (max-width: 767px) {
        /* 모바일 화면에서만 적용되는 스타일 */
        .event-card {
          padding-left: 0px;
          padding-right: 0px;
        }
        .event-card-description {
          font-size: 14px;
        }
        .event-card-title {
          font-size: 23px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-md-8">
          <div class="event-card">
            <p class="event-card-description">
              "개발자, 비개발자 전에 우리 모두는 문학가였다"
            </p>
            <h5 class="event-card-title">
              제1회 샌드뱅크 개발문학 페스티벌 📖
            </h5>
          </div>
        </div>
      </div>
      <div class="row justify-content-center">
        <div class="col-md-8">
          <div class="event-card">
            <p class="event-card-description">
              🎍 주제: 개발, 코드, 인생, 사랑, 우주, 그리고 모든 것
            </p>
            <p class="event-card-description">
              📅 기한: 2023년 5월 28일(일) 23:59:59
            </p>
            <p id="countdown" class="event-card-description"></p>
            <p class="event-card-description">
              💰 상금: 0.06 ETH(1등), 50 USDT(2등), 20 USDT(3등)
            </p>
          </div>
        </div>
      </div>
      <div class="row justify-content-center">
        <div class="col-md-6">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">참여하기 🙋</h5>
              <form
                action="https://script.google.com/macros/s/AKfycbxNsyC-EsyFb4qEA5hSdv_2wl8qCLNrcIGr0m5vaBdOLY9ytSnt9kdBT7Mzh1-AGsUFYQ/exec?function=doPost"
                method="post"
              >
                <div class="form-group">
                  <label for="name">이름</label>
                  <input
                    type="text"
                    class="form-control"
                    id="name"
                    name="name"
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="email">이메일 주소</label>
                  <input
                    type="email"
                    class="form-control"
                    id="email"
                    name="email"
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="text">Show your code</label>
                  <textarea
                    class="form-control"
                    id="text"
                    name="text"
                    rows="5"
                    required
                  ></textarea>
                </div>
                <button type="submit" class="btn btn-primary btn-block">
                  제출
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>
      <div class="row justify-content-center review">
        <div class="col-md-8">
          <div class="event-card">
            <h5 class="event-card-title">지금까지 제출한 작품들 📝</h5>
          </div>
        </div>
      </div>
      <div class="card-container row"></div>
      <div class="row justify-content-center logo-container">
        <span class="powered-by">powered by</span>
        <img src="white.png" alt="회사 로고" class="logo" />
      </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
    <script>
      $(document).ready(function () {
        var cardContainer = $(".card-container");
        cardContainer.html(
          '<div class="loading-text">작품을 불러오고 있습니다...</div>'
        );

        $.getJSON(
          "https://script.google.com/macros/s/AKfycbxNsyC-EsyFb4qEA5hSdv_2wl8qCLNrcIGr0m5vaBdOLY9ytSnt9kdBT7Mzh1-AGsUFYQ/exec?function=doGet",
          function (data) {
            cardContainer.empty(); // 이전 카드 삭제

            for (var i = data.length - 1; i >= 0; i--) {
              var item = data[i];
              var cardText = item.text
                ? item.text.replace(/\r\n/g, "<br>")
                : "";

              var card = `
    <div class="col-md-6 col-lg-4 mb-3">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">${item.name}</h5>
          <p class="card-text">${cardText}</p>
        </div>
      </div>
    </div>
  `;

              cardContainer.append(card); // prepend 메서드를 사용하여 역순으로 카드 추가
            }
          }
        );
      });
    </script>
    <script>
      // 특정 시간 설정 (예: 2023년 5월 31일 12시 0분 0초)
      var targetDate = new Date("2023-05-28T23:59:59");

      function updateCountdown() {
        var now = new Date();
        var timeDiff = targetDate - now;

        // 시간, 분, 초 계산
        var days = Math.floor(timeDiff / (1000 * 60 * 60 * 24));
        var hours = Math.floor(
          (timeDiff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)
        );
        var minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));
        var seconds = Math.floor((timeDiff % (1000 * 60)) / 1000);

        // 결과를 HTML 엘리먼트에 업데이트
        var countdownElement = document.getElementById("countdown");
        countdownElement.innerHTML =
          "- 🕓 " +
          days +
          "일 " +
          hours +
          "시간 " +
          minutes +
          "분 " +
          seconds +
          "초 -";
      }

      // 일정한 간격으로 시간 업데이트
      setInterval(updateCountdown, 1000);
    </script>
    <script>
      // 폼 제출 시 이벤트 핸들러
      $("form").submit(function (event) {
        event.preventDefault(); // 폼 제출 동작 중지

        // 서버로 데이터 전송
        $.ajax({
          url: "https://script.google.com/macros/s/AKfycbxNsyC-EsyFb4qEA5hSdv_2wl8qCLNrcIGr0m5vaBdOLY9ytSnt9kdBT7Mzh1-AGsUFYQ/exec?function=doPost",
          method: "POST",
          data: $("form").serialize(),
          success: function (response) {
            // 성공적으로 응답을 받은 경우
            alert("제출이 완료되었습니다."); // 팝업 메시지 표시
            location.reload(); // 페이지 리프레시
          },
          error: function (error) {
            // 오류 발생 시
            alert("제출에 실패했습니다. 다시 시도해주세요.");
          }
        });
      });
    </script>
  </body>
</html>
